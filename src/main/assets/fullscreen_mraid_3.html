<!DOCTYPE html>
<html>

<head>
    <title>AFA Ad</title>
    <script>
	function afaClicked() {
	    mraid.open("[@CLICK_URL]");

	    /*
		setTimeout(function() {
			window.open("[@CLICK_URL]", "_blank");
			window.location = 'afa://clicked';
		}, 0);*/
	}
	</script>
</head>

<body>
<script src="mraid.js"></script>
<div id="container" style="width:100%;height:100%;background-color:black;text-align:center;margin: 0 auto;">
    <video id="adVideo" onclick="afaClicked()" style=";margin:0 auto;" poster="noposter" src="[@MAIN_IMAGE]" webkit-playsinline></video>
</div>
<style type="text/css">
	html {
  		height: 100%;
	}
	body {
	    min-height: 100%;
		background-color: black;
		margin:0px;
		padding:0px;
		align-items: center;
  		display: flex;
	}
</style>
<script type="text/javascript">
	document.getElementById("container").addEventListener('touchmove', function(event) {
		event.preventDefault();
	}, false);
</script>
<script type="text/javascript">
	function mraidIsReady() {
		mraid.removeEventListener("ready", mraidIsReady);
		prepareMyAd();
	}

	function prepareMyAd() {
		if(mraid.supports("inlineVideo")) {
			// Hide close button

			mraid.useCustomClose(false);
		}
		// Force landscape orientation

		mraid.setOrientationProperties({
			"allowOrientationChange": false,
			"forceOrientation": "portrait"
		});
		// Adjust dimensions for device using current orientation to find landscape values

		var screenSize = mraid.getScreenSize();
		var screenLandscapeWidth = screenSize.width;
		var screenLandscapeHeight = screenSize.height;

/*
		if ( (window.orientation == 0) || (window.orientation == 180) )
		{
		// If device is in portrait swap dimensions
            screenLandscapeWidth = screenSize.height;
            screenLandscapeHeight = screenSize.width;
		}
*/

		document.getElementById("container").style.width = screenLandscapeWidth + "px";
		document.getElementById("container").style.height = screenLandscapeHeight + "px";
		// First video to fit full width and and then scale height

		var videoWidth = 1080;
		var videoHeight = 1920;
		var videoRatio = videoWidth / videoHeight;
		var newWidth = videoWidth;
		var newHeight = videoHeight;
		if(videoWidth > screenLandscapeWidth) {
			newWidth = screenLandscapeWidth;
			newHeight = newWidth / videoRatio;
		} else {
			newWidth = Math.max(screenLandscapeWidth, videoWidth);
			newHeight = newWidth / videoRatio;
		}
		// If scaled height too big then scale back until it fits

		if(newHeight > screenLandscapeHeight) {
			videoRatio = videoHeight / videoWidth;
			newHeight = screenLandscapeHeight;
			newWidth = newHeight / videoRatio;
		}
		// Calculate margins to center

		var topBottomMargins = (screenLandscapeHeight - newHeight) / 2.0;
		var leftRightMargins = (screenLandscapeWidth - newWidth) / 2.0;
		// Update video dimensions

		var video = document.getElementById("adVideo");
		video.style.width = newWidth + "px";
		video.style.height = newHeight + "px";
		//video.style.margin = topBottomMargins + "px " + leftRightMargins + "px";
		// See if ad is visible yet otherwise wait for it to be visible.

		if(!mraid.isViewable()) {
			mraid.addEventListener("viewableChange", isInterstitialDisplayed);
		} else {
			showMyAd();
		}
	}

	function isInterstitialDisplayed(displayed) {
		if(displayed) {
			mraid.removeEventListener("viewableChange", isInterstitialDisplayed);
			showMyAd();
		}
	}

	function showMyAd() {
		// Count impressions at this point and play video ad

		document.getElementById("adVideo").load();
		document.getElementById("adVideo").play();
		// If we can play inline then we can auto close the ad on finish
		if(mraid.supports("inlineVideo")) {
			// Close video on finish
			document.getElementById("adVideo").addEventListener('ended', function() {
				mraid.complete();
			});
		}
	}

	function setupViewport(width) {
		var element = document.querySelector("meta[name=viewport]");
		if(!element) {
			element = document.createElement("meta");
			element.name = "viewport";
			element.content = "width=" + width + ", user - scalable = no ";
			document.getElementsByTagName('head')[0].appendChild(element);
		} else {
			element.content = "width=" + width + ", user - scalable = no ";
		}
	}
	//setupViewport(320);

	function doReadyCheck() {
		if(mraid.getState() == 'loading') {
			mraid.addEventListener("ready", mraidIsReady);
		} else {
			prepareMyAd();
		}
	}

	doReadyCheck();

</script>
</body>

</html>